call mtr.add_suppression("Can't init tc log");
call mtr.add_suppression("Aborting");
RESET MASTER;
CREATE TABLE t ( f INT ) ENGINE=INNODB;
INSERT INTO t VALUES (10);
SET GLOBAL DEBUG_DBUG="d,simulate_crash_after_binlog_write";
INSERT INTO t VALUES (20);
ERROR HY000: Lost connection to MySQL server during query
SELECT * FROM t;
f
10
include/show_binlog_events.inc
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
master-bin.000001	#	Gtid	#	#	GTID #-#-#
master-bin.000001	#	Query	#	#	use `test`; CREATE TABLE t ( f INT ) ENGINE=INNODB
master-bin.000001	#	Gtid	#	#	BEGIN GTID #-#-#
master-bin.000001	#	Query	#	#	use `test`; INSERT INTO t VALUES (10)
master-bin.000001	#	Xid	#	#	COMMIT /* XID */
DROP TABLE t;
show binlog events in 'master-bin.000003' limit 1,1;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
master-bin.000003	#	Gtid_list	1	#	[0-1-2]
